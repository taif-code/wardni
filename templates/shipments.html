{% extends "base.html" %}
{% block content %}
<h2>{{ T.manageShipments }}</h2>

<form method="post" class="form grid4">
  <input name="id" placeholder="{{ T.id }} ({{ T.optional|default('اختياري') }})">
  <input name="origin" placeholder="{{ T.origin }}" value="{{ 'الطائف'|trans }}">
  <input name="destination" placeholder="{{ T.destination }}" value="{{ 'الرياض'|trans }}">
  <input name="temp" placeholder="{{ T.temperature }}" type="number" step="0.1" value="10">
  <input name="status" placeholder="{{ T.status }}" value="{{ 'في الطريق'|trans }}" class="col2">
  <button class="btn col2" type="submit">{{ T.createShipment }}</button>
</form>

<div class="tablewrap">
  <table class="table">
    <thead>
      <tr>
        <th>{{ T.id }}</th>
        <th>{{ T.route }}</th>
        <th>{{ T.temperature }}</th>
        <th>{{ T.station_col }}</th>
        <th>{{ T.status }}</th>
      </tr>
    </thead>
    <tbody>
      {% for r in shipments %}
      <tr>
        <td>{{ r.id }}</td>

        <td>
          {% if r.legs is defined and r.legs and (r.legs|length) > 0 %}
            {% for lg in r.legs %}
              <div>
                <small>
                  <strong>{{ lg.from|trans }}</strong>
                  <span class="dir-arrow"></span>
                  <strong>{{ lg.to|trans }}</strong>
                </small>
                <span class="muted">({{ lg.status|trans }})</span>
              </div>
            {% endfor %}
          {% else %}
            {{ r.origin|trans }} <span class="dir-arrow"></span> {{ r.destination|trans }}
          {% endif %}
        </td>

        <td>{{ r.temp }}{{ T.tempUnit }}</td>

        <td>
          {% if r.station is defined and r.station %}
            <span class="badge warn">{{ r.station|trans }}</span>
          {% else %}
            {{ T.notFound }}
          {% endif %}
          {% if r.status %}
            <small class="muted">• {{ r.status|trans }}</small>
          {% endif %}
        </td>

        <td>
          {% if is_delivered(r.status) %}
            <span class="badge success">{{ r.status|trans }}</span>
          {% else %}
            <span class="badge warn">{{ r.status|trans or T.notFound }}</span>
          {% endif %}
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
